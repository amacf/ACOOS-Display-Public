<script type="text/javascript">
$(document).ready(function(){   
  $(".navbar").on("click touchend","input",function(){   
        var request = new XMLHttpRequest();
        request.open('get', '/keyOpen', false);
        request.send(null);
  });
  $(".peoplepage").on("click touchend",function(){
          if(!$(event.target).is("input")){
          var request = new XMLHttpRequest();
          request.open('get', '/keyClose', false);
          request.send(null);
    }
  });
});
</script>

<span class='peoplepage'>
  <div class="navbar">

  <%= form_tag({controller: :people, action: :kioskIndex, page: 1}, method: "get") do %>
  <input type="text" name="search" id="textBox" value=<%= params[:search] %>>
  <input type="submit" id="searchButton" value="Search">
  <% end %>
  </div>

  <div class="peoplebox">

    <ul>
      <% @people.each do |person| %>
        <%= link_to person do %>
          <div class="personbox">
            <%= image_tag(person.image.url(:thumb)) %>
            <h2><%= person.name %></h2>

            <% if !person.birthdate.blank? && person.deathdate.blank? %>
              <p>Born: <%= person.birthdate %></p>
            <% elsif person.birthdate.blank? && !person.deathdate.blank? %>
              <p>Died: <%= person.deathdate %></p>
            <% elsif !person.birthdate.blank? && !person.deathdate.blank? %>
              <p><%= person.birthdate %> - <%= person.deathdate %></p>
            <% end %>

            <% if !person.birthplace.blank? && person.deathplace.blank? %>
              <p><%= person.birthplace %></p>
            <% elsif person.birthplace.blank? && !person.deathplace.blank? %>
              <p><%= person.deathplace %></p>
            <% elsif !person.birthplace.blank? && !person.deathplace.blank? %>
              <p><%= person.birthplace %> - <%= person.deathplace %></p>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </ul>

    <br>
  </div>

  <div class="pagebar">
    <hr>
      <center><h2>
        <% unless @currentPage == 1 %>
          <%= link_to controller: :people, action: :kioskIndex, page: @currentPage-2, search: params[:search] do %>
            <span id=leftbutton> <span id="leftarrow">&#10144;</span>Prev</span>
          <% end %>
        <% else %>
          <span id=leftbutton> <span id="leftarrow">&#10144;</span>Prev</span>
        <% end %>
        Page <%= @currentPage %> of <%= @totalPages %>
        <% unless @currentPage == @totalPages %>        
          <%= link_to controller: :people, action: :kioskIndex, page: @currentPage, search: params[:search] do %>
            <span id="rightbutton">Next&#10144;</span>
          <% end %>
        <% else %>
          <span id="rightbutton">Next&#10144;</span>
        <% end %>
      </h2></center>
  </div>

</span>
